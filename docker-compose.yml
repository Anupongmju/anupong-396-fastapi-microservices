version: "3.9"

# docker-compose ใช้สำหรับรันหลาย service พร้อมกัน
# แต่ละ service จะรันใน container แยกกัน (microservices)

services:
  service_a:
    # สร้าง image จาก Dockerfile ในโฟลเดอร์ service_a
    build: ./service_a
    # เปิด port สำหรับ gRPC
    ports:
      - "50051:50051"

  service_b:
    # service_b เป็น REST + gRPC client
    build: ./service_b
    ports:
      - "8001:8000"
    # ต้องรอให้ service_a พร้อมก่อน
    depends_on:
      - service_a

  service_c:
    # service_c เป็น API Gateway
    build: ./service_c
    ports:
      - "8000:8000"
    # ต้องรอ service_b
    depends_on:
      - service_b
